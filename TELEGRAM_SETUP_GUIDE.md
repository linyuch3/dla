# Telegram 通知设置使用说明

## 📱 如何配置 Telegram 通知

### 1. 获取 Bot Token

1. 在 Telegram 中搜索 [@BotFather](https://t.me/BotFather)
2. 发送 `/newbot` 命令
3. 按提示设置 Bot 名称和用户名
4. 复制 BotFather 返回的 Token（格式：`1234567890:ABCdefGHIjklMNOpqrSTUvwxyz`）

### 2. 获取您的 Telegram 用户 ID

1. 在 Telegram 中搜索 [@userinfobot](https://t.me/userinfobot)
2. 点击 Start 或发送任意消息
3. Bot 会返回您的用户 ID（纯数字，如：`123456789`）

### 3. 在 CloudPanel 中配置

1. 点击右上角用户菜单 → **用户设置**
2. 找到 **Telegram 通知** 区域
3. 输入获取到的 **Bot Token**
4. 输入您的 **Telegram 用户ID**
5. 点击右侧开关**启用通知**
6. 点击**保存设置**按钮
7. 点击**发送测试**验证配置是否正确

### 4. 启动与您的 Bot 对话

⚠️ **重要**：配置完成后，必须在 Telegram 中找到您的 Bot 并发送 `/start` 命令，否则 Bot 无法给您发送消息！

1. 在 Telegram 搜索框中输入您的 Bot 用户名
2. 点击进入对话
3. 点击底部的 **START** 按钮或发送 `/start`

## 🔔 您将收到的通知

配置成功后，以下操作会自动发送 Telegram 通知：

- ✅ **创建实例** - 显示实例名、IP、区域
- ▶️ **开机/关机/重启** - 显示操作和实例信息
- 🔀 **更换IP** - 显示旧IP和新IP
- 🗑️ **删除实例** - 删除确认通知
- 🚀 **自动补机** - 补机成功通知
- 🔴 **API密钥失效** - 密钥无法使用时警告
- 🟡 **API密钥受限** - 密钥调用受限时提醒

## 🕐 定时任务

系统会自动执行以下定时任务：

- **每 6 小时**: 自动测试所有 API 密钥健康状态
- **每天 00:00 UTC**: 每日健康检查报告

## ❓ 常见问题

### Q: 为什么我收不到通知？

A: 请检查：
1. Bot Token 和用户 ID 是否正确
2. 是否已在 Telegram 中与 Bot 对话并发送 `/start`
3. 是否已启用通知（开关打开）
4. 是否已点击保存设置

### Q: 如何修改 Bot Token？

A: 直接在输入框中输入新的完整 Token，然后保存即可。

### Q: Token 显示为 `123456789012...ABCD` 是什么意思？

A: 这是安全显示，表示已保存 Token。如果不需要修改，保存时会保持原有 Token。

### Q: 如何关闭通知？

A: 关闭右侧的**启用通知**开关，然后点击保存设置即可。

## 🔒 安全说明

- Token 在数据库中使用 AES-256-GCM 加密存储
- 前端显示时仅显示部分内容（前12位...后4位）
- 不会在日志中输出完整 Token
